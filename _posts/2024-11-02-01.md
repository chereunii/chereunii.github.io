---
layout: post
title:  "10장 인과와 상관, 11장 베이즈 통계"
date:   2024-11-02 
categories: Khuda 통계101
---

#10장 인과와 상관

# 10.1 인과와 상관

**인과관계:** 원인과 결과의 관계를 뜻한다.

**상관관계:** 데이터에서 보이는 관련성을 말한다.

두 변수에 관련된 외부 변수가 존재할 때, 이를 **중첩**이라 하며, 그 변수를 **중첩요인** 이라 한다. 

**허위상관:** 인과관계는 없지만 상관관계는 있을 때를 말한다. 인과관계가 있는 것처럼 보이는 상관이라는 뜻이다. 

상관관계가 있을 때 인과관계가 있는 경우도 있고, 인과관계가 없는 경우도 있다.

인과관계를 알면 상관관계를 알 때보다 더 많은 것을 이해할 수 있다. 원인 변수를 변화시킴으로써(개입), 결과 변수를 바꿀 수 있다. 한편 2개 변수 사이에 인과관계 없고 상관관계만 있는 경우 한쪽 변수를 변화시켜도 다른 한쪽 변수는 달라지지 않는다. 

상관관계가 있다면 그 사이에 인과관계가 존재할 가능성이 있다. 상관관계는 2개 변수 X,Y사이의 관련성이므로, 한쪽 변수로부터 또 다른 변수를 예측할 수 있다. 

중첩요인이 되기 쉬운 변수에는 시간 또는 나이가 있다. 유명한 예로 국가별 초콜릿 소비량과 노벨상 수상자 간 양의 상관이 있다는 내용이 2012년 뉴잉글랜드저널오브메디슨에 실렸다.  GDP가 중첩요인으로 작용한다고 생각할 수 있다. GDP가 높을수록 초콜릿 소비량이 늘어나며, 또 GDP가 높을수록 연구에 많은 투자가 이루어져 노벨상 수상이 증가할 가능성이 크다는 것이다. 인과관계는 없지만, 초콜릿 소비량을 아는 경우 노벨상 수상자 수를 어느 정도 예측할 수는 있을 것이다. 

# 10.2 무작위 통제 실험

인과관계 발견이 어려운 이유 중 하나는 **중첩요인**의 존재이다. 

예를 들어 음주와 폐암의 예로 알아보자. 관찰 데이터에서 음주 집단과 금주 집단 사이 폐암 발병률을 비교하면, 분명 음주 집단에서 폐암 발병이 많다는 것을 알 수 있다. 그러나 음주 집단과 금주 집단의 흡연/비흡연 비율은 애당초 서로 다르다. 이렇게 해서 흡연 효과가 포함되어 버리므로 음주가 폐암 발병에 미치는 효과를 비교하려 해도 그것이 음주 효과때문인지 흡연 효과 때문인지 구별할 수 없다. 따라서 음주가 폐암에 미치는 효과를 알고자 한다면, 음주 이외의 요인을 동일하게 하지 않으면 안된다. 

변수 X에서 변수Y로의 인과효과를 추정하는 가장 강력한 방법은 무작위 통제 실험이다. 알고자 하는 요인인 변수 X에 표본을 무작위로 할당하고 개입 실험을 수행한 다음, 변수 Y와 비교하는 방법이다. 

# 10.3 통계적 인과 추론

언제나 개입 실험이 가능한 것은 아니다. 왜냐하면, 개입 실험을 하기엔 윤리적인 문제가 있거나 개입 자체가 불가능할 때가 있기 때문이다. 이에 무작위 통제실험 없이 실제 데이터에서 인과효과를 추정하고자 하는 발상이 생겨났다. **통계적 인과 추론**이라는 인과 효과의 추정 방법 및 통계적 인과 탐색이라는 인과구조의 지정 방법 개발이 활발하게 진행중이다. 

**층별 해석**: 중첩요인을 기준으로 데이터를 몇 가지 그룹으로 나누어, 각 층 안에서 중첩요인의 효과를 가능한 한 작게 하는 방법

**짝짓기:** 원인변수=0인 집단과 원인변수=1인 집단에서 비슷한 중첩요인을 가진 데이터를 골라 쌍으로 만드는 방법.

**이중차분법**: 시간 축을 도입, 집단 간 차이에 대해 다시 한번 처리 전후의 차분을 취함으로써 인과효과를 추정하는 방법.

# 11장 베이즈 통계

# 11.1 베이즈 통계의 사고방식

빈도주의 흐름에서의 불확실성은, 모집단에서 표본을 추출할 때의 불확실성이다. **빈도주의**에서의 확률은 무한히 반복 실행한 결과로서의 객관적인 빈도를 나타낸다. 반면 **베이즈 통계**는 확률을 얼마나 확신하는지로 해석하는 원리이다. 

**베이즈 통계**: 확률을 기반으로 가설의 신뢰도를 업데이트하는 통계 방법. 이 방법은 새로운 데이터가 주어졌을 때 기존의 믿음을 조정해 새로운 믿음을 계산한다. 

**최대 가능도 방법:** 주어진 데이터가 관측될 확률을 최대화하는 파라미터 값을 찾는 통계적 방법이다. 주어진 데이터가 특정 분포를 따를 때, 그 분포의 파라미터가 참 값이라고 가정한다. 그러면 관측된 데이터가 주어졌을 때, 이 데이터가 나올 확률을 가능도 함수라고 한다. 이 가능도 함수를 최대화하는 값을 찾는 것이 최대 가능도 방법이다. 

**베이트 통계 이점**

- 추정 결과, 통계 모형의 파라미터를 분포로 얻을 수 있다.
- 베이즈 통계에서 이용하는 계산 방법인 MCMC방법이 난수를 발생시켜 시뮬레이션으로 사후분포를 따르는 파라미터를 얻기 때문에 복잡한 모형화가 가능하다.

# 11.2 베이즈 통계 알고리즘

**MCMC방법** 자체는 특정 확률분포를 따르는 난수 발생 알고리즘이다. 베이즈 통계에서는 이것을 이용해 사후분포를 따르는 난수를 발생시키고 그 난수의 집합을 관찰함으로써 사후분포의 성질을 분석한다. 

**몬테카를로 방법**: 난수를 여러 개 발생시켜 시뮬레이션해 근사해를 얻는 방법. 무작위 샘플링을 사용하여 복잡한 문제를 해결하거나 근사하는 계산 방법. 주로 확률이 개입된 문제를 해결하는 데 사용되며, 과학, 공학, 금융, 컴퓨터 과학 등 다양한 분야에서 활용된다. 이 방법은 복잡한 수학적 계산을 반복적인 난수 생성과 시뮬레이션을 통해 근사적으로 계산한다.

**마르코프 연쇄:** 어떤 상태에서 다른 상태로 변화하는 현상을 확률로 표현한 모형의 일종. 현재 상태가 미래 상태에 영향을 주지만, 과거 상태에는 의존하지 않는 특성을 가진 확률적 상태 전이 모델이다. 즉, "현재 상태만 알면 미래 상태를 예측할 수 있다"는 **마르코프 특성**을 가지고 있다. 이 모델은 연속적인 상태 변화가 있을 때 각 상태 간 전이 확률을 사용하여 상태 변화 과정을 설명한다.