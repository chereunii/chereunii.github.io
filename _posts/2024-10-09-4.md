---
layout: post
title:  "9장 가설검정의 주의점"
date:   2024-10-09 
categories: Khuda 통계101
---

# 9.1 재현성

**재현성**: 특정 연구나 실험의 결과를 동일한 조건과 방법으로 반복했을 때, 같은 결과를 얻을 수 있는 능력을 의미한다. 과학연구에서 매우 중요한 개념으로, 어떤 결과가 재현 가능하다는 것은 해당 결과가 우연이나 실수에 의한 것이 아니라 일관된 과학적 사실임을 보여준다. 

→ **재현성 위기:** 재현성이 없다는 것은 원래 논문의 주장이 잘못되었을 가능성이 있다는 것

![Untitled](/assets/HW1/ii28.png)

### 재현 불가능한 원인?

1. 실험 조건을 동일하게 조성하기 어렵다.
2. 가설검정의 사용 방법에 있다 : p값이 설정한 유의수준 a(0.05)보다 작아야 함.→조작가능 

**p-해킹** :  연구자가 통계적으로 유의미한 결과를 얻기 위해 데이터나 분석 방법을 조작, 변경하는 관행 

- 과학 논문 게재 과정

연구자는 다른 연구자가 발표한 논문을 읽으며 인용하거나 아이디어를 얻는 등 도움을 받는다. → 단번에 게재 결정될 때는 거의 없으며 개선 여지가 있다면 수정, 해석 추가 요청 →이러한 몇번의 과정 후 적절한 수정이 이루어졌다고 판단하면 게재됨

거절되면 다른 저널에 투고할 것을 고려한다. 투고 논문 중 최종 게재되는 논문의 비율이 한자리수에 불과한 저널도 있다. 하지만 이러한 논문 게재 가부는 단 몇 명이 판단할 뿐이라 논문에 잘못이 있을 가능성도 있다. 

논문 출판에서는 논문의 주요 주장에 대해 통계적으로 유의미한 결과(p<0/05)를 얻지 못한 경우, 가설을 지지하지 않기에 게재가 거절될 수 있다. p≥ 0.05인 결과는 세상에 나오지 못하게 함으로써, 출판된 내용에 치우침이 생긴다는 **출판 편향** 문제를 일으킨다.  

![Untitled](/assets/HW1/ii29.png)

# 9.2 가설검정의 문제점

가설검정 원리와 p값을 이해하지 못한 채 사용하는 사람이 많다.

왜 a= 0.05를 사용하는가?

통계학자 로널드 피셔가 자의적임을 인정하면서도 증거의 강력함을 나타내는 지표로 사용한 것이 그 시작, 현대 과학에서는 이를 관례처럼 사용.

a=0.05라는 숫자를 사용해 얻은 통계적으로 유의미한 결과 중, 실제로는 귀무가설이 옳았을 비율이 뜻밖에 높다.

### 피서류 검정과 네이만-피어슨류 검정

**피서류 검정**: p값을 이용해 데이터의 유의성을 판단하는 방식, 가설의 유의성에 대한 통찰을 제공하지만 명확한 기각/채택 규칙은 없다.

**네이만-피어슨류 검정**: 두 가설을 비교하고 오류 확률을 고려해 명확한 기각 또는 채택 결정을 내리는 방식이다.

단,  표본크기 n을 미리 결정해야 한다. 

![Untitled](/assets/HW1/ii30.png)

유의수준, 검정력(대립가설 참일 때 이를 올바르게 검출할 확률), 효과크기(두 그룹 간의 차이가 얼마나 큰지), 표본크기 

표본크기 n이 커지면 p값은 작아지므로 검출하고자 하는 효과크기를 사전에 설정하고 표본크기 n을 설계해야 한다는 점이다. → p<0.05에만 관심을 두어서는 안되고 효과크기나 신뢰구간을 나타내는 것도 중요하다. 

- **효과크기(effect size)**: 두 그룹 간의 차이의 크기 또는 관계의 강도를 측정하는 지표. 통계적 가설 검정에서 단순히 유의미한 결과를 얻는 것뿐만 아니라 그 차이가 실제로 얼마나 중요한지를 파악하기 위해 사용된다.

2개의 모집단평균이 얼마나 떨어져 있는지를 나타내는 Cohen’sd가 있다.

![Untitled](/assets/HW1/ii31.png)

![Untitled](/assets/HW1/ii32.png)

![Untitled](/assets/HW1/ii27.png)


→효과크기가 클수록 (d값이 클수록) 두 그룹의 분포가 더 많이 분리된다. 작을수록 두 그룹 분포가 더 겹치며 차이가 작음을 알 수 있다. 또한, 표준편차가 작을수록 효과크기가 커진다.

![Untitled](/assets/HW1/ii33.png)

통계적으로 유의미한 차이가 없다 → 귀무가설을 채택한다는 것이 아니라 판단 보류의 뜻 → p값 대신 **베이즈 인수 지표** 사용

**베이즈 인수**: 통계학에서 두 가설 중에서 데이터를 가지고 어느 쪽이 더 타당한지 비교하기 위한 지표. p값과는 다르게 데이터가 주어졌을 때 어느 가설을 더 지지하는지를 확률적으로 나타낸다. 

![Untitled](/assets/HW1/ii34.png)

1≤B<3.2 : 약한 증거

3.2≤ B<10 : 중간 정도의 증거

B ≥ 10 :강한 증거

### 논문이 옳지 않을 확률

**허위발견율 (FDR, False discovery rate):** 옳다고 주장된 것 중 위양성인 것의 비율, 작은 것이 바람직하다. 

![Untitled](/assets/HW1/ii35.png)

# 9.3 p-해킹

**p-해킹**: 의도하든, 의도하지 않든 p값을 원하는 방향으로 조작하는 행위 

수치를 고친다기보다는 p값이 0.05 미만이 되도록 실험을 설계하거나 해석하는 것을 말한다. 

e.g.

1. p<0.05가 될 때까지 표본크기 n을 늘린다. 
2. 처음에는 n=30으로 실험하여 p=0.07이었지만, 표본크기 n=10을 추가해 n=40으로 실험했더니, p<0.05이 되었기에 이를 보고함.
3. 여러 개의 요인을 탐색하여 그중 p<0.05인 것만 보고함.

- 1,2번의 문제

![Untitled](/assets/HW1/ii36.png)

3번의 문제

**HARKing**: ‘Hypothesis After the Results are Known’의 약자로, 데이터를 얻어 결과를 보고 나서 가설을 만드는 행위이다. 많은 실험 반복하거나 데이터의 다양한 변수를 이리저리 만져서 의미가 있을듯한 결과만을 뽑아, 처음 세운 가설인양 보고하는 것이다. → 재현성 저하

### p-해킹을 예방하기

탐색형 연구: 전체를 탐색적으로 해석하는 연구

→해석에 사용한 변수 모두 보고하고, 검정을 반복한 횟수로 유의수준 a를 나누는 본페로니 교정으로 이를 보정해야 한다.

→ 다중성을 놓치기 쉬움

**가설검증형 연구**: 가설을 세우고 이를 검증하는 연구

**사전등록**: 연구를 실시하기 전에 가설과 실험 설계, 분석 방법 등의 연구 계획을 등록하는 것

→ 데이터를 얻은 다음 가설을 세우는 HARKing을 막을 수 있다.

- p값 관련 문제 정리

p값을 제대로 이해하고 사용한다.

가설검정을 반복하면 다중성 문제가 발생하고, 위양성이 증가한다는 것을 이해한다. 

탐색형 연구와 가설검증형 연구의 차이를 이해한다.

실시한 실험이나 해석은 제대로 보고한다.

재현성이 있는지 염두에 둔다. 가능하다면 재실험하여 확인한다.

좋은 가설을 세운다.
