---
layout: post
title:  "6장 다양한 가설검정"
date:   2024-10-02
categories: Khuda 통계101
---

# 6.1 다양한 가설검정

가설검정 흐름

1. 확인하고 싶은 대상에 따라 귀무가설과 대립가설을 설정한다.
2. 데이터로 가설검정에 필요한 검정통계량을 계산한다.
3. 귀무가설이 옳다는 가정하에 통계량의 분포를 생각하고, 데이터로 계산한 통계량이 분포의 어느 위치에 있는지를 구하여 p값을 계산한다.

가설검정 방법을 선택할 때는 다음에 설명하는 데이터 유형, 표본의 수, 양적 변수분포의 성질을 먼저 확인하기!

- 데이터 유형

각 상태에 몇 개(몇 명) 데이터가 있는지를 나타내는 표를 **분할표**라 한다.

어느 쪽이든 데이터 유형이 양적 변수인지 질적 변수인지에 따라 해석 방법이 달라지므로 데이터 유형부터 확인하기

![Untitled](/assets/HW1/hh16.png)

- 표본의 수

표본의 수(집단수)도 분석 방법 선택에서 중요한 요소이다.

![Untitled](/assets/HW1/hh17.png)

- 양적 변수의 성질

데이터에 양적 변수가 있는 경우, 이것이 **어떤 분포를 취하는지**가 검정 방법을 선택할 때 중요하다. t검정은 데이터가 발생한 모집단이 정규분포라고 가정한 방법이었다. 이처럼 모집단이 수학적으로 다룰 수 있는(파라미터로 설명가능한) 특정 분포를 따른다는 가정을 둔 가설검정을 **모수검정**이라 한다.

데이터가 정규분포로부터 얻어졌다고 간주할 수 있는 성질을 **정규성**이라 한다.

모집단분포가 특정 분포라 가정할 수 없는 경우(좌우 비대칭, 이상값 등 존재)는 모수검정이 아닌 **비모수 검정**을 이용한다. 비모수 검정은 평균이나 표준편차 등의 파라미터에 기반을 두지 않는 방법이다.

# 6.2 대푯값 비교

- 일표본 t검정

일표본 t검정에서는 2가지 조건을 비교하는 것이 아니라, 어떤 평균값의 모집단에서 표본을 얻었는가를 조사하는 것이다.

귀무가설 “모집단의 평균은 m=00이다.”

대립가설 “모집단의 평균은 m=00이 아니다.”

의 전제로 하여 검증한다.

즉,유의수준 a=0.05에서  p<0.05라면 모집단 평균m는 00이 아니라고 판단할 수 있다.

단, m=00으로는 연구의 배경으로서 의미가 있는 값을 고려해야만 한다. 

예시) ‘한국인 성인 남성의 평균 키는 170cm이다.’라는 맥락없이 가설 세워서는 안됨. 가령 ‘중국인 성인 남성의 평균 키는 170cm이다’ 를 아는 상태에서 가설 세워야 검증의미가 있음.

95% 신뢰구간을 구하는 것과 a=0.05의 유의수준으로 귀무가설을 검정하는 것은 x바에서 생각할지 귀무가설 m=00에서 생각할지의 차이일 뿐 동전의 양면과 같은 관계이다.

- 이표본 t검정

귀무가설 “2개 집단의 평균값은 같다(평균값의 차이=0)”

대립가설”2개 집단의 평균값은 다르다(평균값의 차이≠0)”

를 전제로 t검정을 진행한다.

t검정은 모수검정으로 분류되는 검정방법이기에 데이터에 정규성이 있어야 한다. 일반적인 t검정에서는 등분산성을 가정한다.

분산이 일치하지 않는 경우 웰치의 t검정을 이용한다. 

- 대응 관계가 없는 검정과 대응 관계가 있는 검정

지금까지 소개한건 대응 관계 없는 검정이다. 신약 효과를 검증하기 위해 약있음/약없음 2개 집단을 이용하지만 2개 집단의 피험자들 간 대응관계는 없다. 

대응 관계가 있는 검정에서는 한 피험자의 혈압을 약을 복용하기 전과 복용한 후 두차례 검사한다. 약 복용 전의 기준선과 비교해 얼마나 변화했는가를 나타내는 한 집단의 데이터임을 알 수 있다. 

일표본 t검정으로서 ‘차이 평균값=0’을 귀무가설로 삼아 해석 가능하다. 대응관계가 있는 데이터일 때는 똑같이 대응 관계가 있는 검정을 이용하는 편이 좋다. 그러면 제 2종 오류가 발생할 확률이 낮아지며 검정력도 오르는 경향이 있기 때문이다. 

- 정규성 조사

모수검정에서는 각 집단의 데이터에 정규성 있어야 한다. 정규성을 조사하는 방법에는 시가적으로 판단할 수 있는 **Q-Q플롯**, 가설검정으로 조사하는 **샤피로-윌크검정**, 이론적인 분포와 비교하는 **콜모고로프-스미르노프(K-S**)검정 등이 있다. 

귀무가설 “모집단이 정규분포이다.”

대립가설”모집단이 정규분포가 아니다.”

p≥0.05면 정규성 있음, p<0.05면 정규성 없다고 판단(귀무가설 기각할 수 없다고 해서 귀무가설이 옳다는 증거가 되지는 않음)

- 등분산성 조사

분산이 같다는 가설을 조사하는 검정으로는 **바틀렛 검정**이나 **레빈 검정**이 있다. 

귀무가설”2개 모집단의 분산은 같다.”

대립가설”2개의 모집단의 분산은 같지않다.”

p≥0.05라면 등분산, p≤0.05라면 부등분산 판단

- 비모수 버전의 2개 표본 대푯값 비교

각 집단 데이터에 정규성이 없는 경우에는 비모수검정으로 분류되는 방법을 사용하는 것 권장. 대표적으로 **윌콕슨 순위합 검정**이 있다. 이것은 평균값 대신 각 데이터 값의 순위에 기반해 검정을 실시한다. 

맨-휘트니U검정도 같은 방법. 이 방법 사용하려면 비교할 2개집단의 분포 모양 자체가 같아야 한다. 

귀무가설”2개 모집단의 위치가 같다”

대립가설”2개 모집단 위치가 다르다”

![Untitled](/assets/HW1/hh18.png)

- 분산분석(3개 집단 이상의 평균값 비교)

3개 이상 집단의 평균값을 비교하는 방법은 분산분석(ANOVA)이다.

각 집단의 평균을 계산하고 각 데이터와 평균의 차이를 구한다. 

![Untitled](/assets/HW1/hh19.png)

**집단 내 변동**은 동일 조건에서의 데이터 퍼짐이므로, 원래 존재하는 **무작위 오차의 크기**를 나타낸다. 

**집단 간 변동**은 집단 간 차이를 나타내며, 집단 간 차이가 있다면 큰 **데이터 퍼짐**, 차이가 없다면 집단 내 편차가 같은 정도로 작은 데이터 퍼짐을 기대할 수 있다.

**F값=평균적인 집단 간 변동/평균적인 집단 내 변동**을 계산해 검정통계량을 만든다. 이 양은 귀무가설이 올바르다는 가정하에 F분포라는 분포 따른다.

F값 이상으로 극단적인 값이 나올 확률이 p값이다. 

- 다중비교 검정

집단 3개 있을 때, 쌍의 수는 3이다. t검정을 3번 반복하면 적어도 한 쌍에서 제1종 오류가 일어날 확률은 1-(어느 쌍에서도 제1종 오류가 일어나지 않을 확률)^3=1-(1-0.95)^3=0.143이 되어 분산분석 전체에서 설정한 유의수준을 상회해 버린다.

집단 수가 늘어날수록 제1종 오류가 일어나기 쉬워진다. 이 다중성 문제를 회피하고자 다중비교 검정을 이용한다. 다중비교 검정의 기본 아이디어는 검정을 반복하는 만큼, 유의수준을 엄격한 값으로 변경하는 것이다 

- 여러 가지 다중비교 방법

가장 단순한 다중비교 방법은 **본페로니 교정**이 있다. 이는 전체에서 유의수준a를 설정했을 때의 검정 반복 횟수를 k라 하고, 매 검정에서는 a를 검정횟수로 나눈 값 a/k를 기준으로 가설검정을 하는 방법이다. p<a/k라면 대립가설을 채택하는 거이다.

본페로니 교정은 간편해 다양한 다중비교에서 사용할 수 있다는 장점이 있다. 그러나 검정력이 낮은 경향이 있어, 정말 차이가 있을 때 차이가 있다고 주장하기 어려울 수 있다는 단점도 있다. 그래서 분산분석 시행 후 **튜키검정** 등 다른 방법을 사용할 때가 있다.

그 밖에도 대조군과 비교에만 관심있을 때는 **던넷 검정**을 이용하면 좋다. 

집단 간 순위를 매길 수 있는 경우에는 **윌리엄스 검정**을 사용하는 편이 좋다. 

![Untitled](/assets/HW1/hh20.png)

본페르니 검정, 튜키 검정, 던넷 검정, 윌리엄스 검정은 분산분석과 다른 원리라 분산분석 없이 단독 수행해도 문제 없다.

정규성이 없는 집단이 1개 이상이라면 분산분석 대신 비모수검정 방법인 크러스컬-윌리스 검정을 사용하는 것 권장. 

# 6.3 비율 비교

하나의 범주가 확률P, 또 하나의 범주가 확률 1-P로 나타나는지를 조사하는 **이항검정**이라는 방법을 사용한다. 

이항검정은 범주가 2개일 때만 이용 가능하다. 그러나 6개의 눈이 있는 주사위나 더 일반적인 이산확률분포에 이항검정의 방식을 적용하고 싶을 때 **카이제곱검정**의 일종인 **적합도검정**을 잉용해 조사할 수 있다. 

먼저 귀무가설의 확률분포에서 얻을 수 있는 기대도수를 계산한다. **(실제 출현도수-기대도수)^2/(기대도수)**를 계산해 이를 더한 값을 구한다. 이를 카이제곱값이라 부른다.