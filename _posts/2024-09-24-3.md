---
layout: post
title:  "4장-5장 추론통계~신뢰구간, 가설검정"
date:   2024-09-16 
categories: Khuda 통계101
---

# 4.1 추론통계를 배우기 전에

모집단 분포가 양적 변수의 평균, 분산 정의할 수 있는데이를 각각 모평균, 모분산이라 한다. 그리고 이러한 모집단분포를 특징 짓는 양을 **모수 또는 파라미터**라 부른다. 모집단을 모두 조사하는 데는 어려움이 따르기에 표본으로 모수를 추정한다.

**확률 분포와 실현값**의 관계는 모집단과 표본의 관계와 매우 비슷하다. **모집단=확률분포**, **표본= 확률분포를 따르는 실현값** 이라 생각하면 된다.

수학적인 확률분포로 모집단분포를 근사하는 것을 **모형화(modeling)**라고 하자.

![Untitled](/assets/HW1/gg18.png)

모집단에서 표본을 얻을 때 중요한 것이 **무작위추출**이다. 이는 데이터를 얻을 때 모집단에 포함된 요소를 하나씩 무작위로 선택하여 추출하는 방식

가장 이상적인 무작위추출 방법은 표본에 있을 수 있는 모든 요소를 목록으로 만들고 난수를 이용해 표본을 정하는 것이다. 이를 **단순무작위추출법**이라 한다. 이와 달리 실제로 자주 사용하는 방법은 **층화추출법**이며 이는 모집단을 몇 개의 층으로 미리 나누고 각 층에서 필요한 수의 조사대상을 무작위로 추출하는 방법이다. 그 밖에도 계통추출법, 군집추출법 등 다양한 방법이 있다. 

시사점1 : 정말로 알고자 하는 것은 표본 데이터가 아니라 모집단이다.

시사점2: 모집단의 모든 요소를 다 조사하는 전수조사는 어렵다.

시사점3: 작은 크기의 표본으로도 모집단을 추론할 수 있다.

시사점4: 표본을 추출할 때는 무작위로 추출해야 한다.

# 4.2 표본오차와 신뢰구간

우리가 정말로 알고 싶은 것은 모집단 평균이지만 직접 알 수 없으므로 모집단의 일부인 크기 n인 표본을 모집단에서 무작위로 추출해 이 표본에서 모집단평균을 추정하는 것으로 생각해가겠다.

하지만 정말로 알고 싶은 것과 실제로 손 안에 있는 데이터에는어긋남(오차)이 생긴다. 이를 **표본오차**라 한다. 

표본은 모집단의 성질과 정확히 일치하지 않고, 확률오차를 수반한다. 그러나 이 오차에 대해 파고들어 생각하는 것이 중요하다. 

**큰 수의 법칙**: 표본크기 n이 커질수록 표본평균이 모집단평균에 한없이 가까워진다는 법칙이다.

**중심극한정리:**모집단이 어떤 분포이든 간에, 표본크기 n이 커질수록 표본평균의 분포는 정규분포로 근사할 수 있다는 것을 의미한다. 

모집단의 성질을 추정하는 데 사용하는 통계량을 **추정량**이라 한다. 표본크기 n을 무한대로 했을 때 모집단의 성질과 일치하는 추정량을 **일치추정량**이라 하고 추정량의 평균값이 모집단의 성질과 일치할 때의 추정량은 **비편향추정량**이라한다. 비편향추정량은 매번 얻을 때마다 확률적으로 다른 값이 되지만, 평균으로 보면 모집단의 성질을 과대하지도 과소하지도 않게 나타내는 양을 뜻한다. 표본평균은 모집단평균을 편향되지 않게 추정하는 비편향추정량이다. 

![Untitled](/assets/HW1/gg19.png)

신뢰구간은 표본에서 구한 모집단의 추정값을 어느 정도 신뢰할 수 있는지를 나태낸다고 할 수 있다.

**t분포**는 모집단이 *정규분포라는 가정하*에 미지의 모집단 표준편차를 표본으로 계산한 비편향표준편차 s로 대용했을 때, x바-m를 표준오차로 나누어 표준화한 값이 따르는 분포이다. 

![Untitled](/assets/HW1/gg20.png)

가설검정에서는 **p값**이라는 수치를 계산해 가설을 지지하는지 여부를 판단한다. 

미리 세운 가설을 검증하는 접근법을 **확증적 자료분석(가설검증형 데이터분석)** 이라 한다. 반대로 가설을 미리 세우지 않고 전체 데이터를 탐색적으로 해석하는 접근법을 **탐색적 자료분석**이라 한다. 

통계학에는데이터에 기반을 둔 통계 가설을 검증하는 방법인 **가설검정**이 있다. 

예를 들어 “신약에 효과가 있다” 라는 가설을 검증하고 싶다.

가설: 신약에 효과가 있다. → 두 모집단의 평균값이 서로 다르다.

가설검정에서 밝히고자 하는 가설의 부정 명제를 **귀무가설**이라 하고, 밝히고 싶은 가설을 **대립가설**이라 한다. 

즉 귀무가설이 옳다면 대립가설이 틀린 것이고 귀무가설이 틀리다면 대립가설이 옳다는 관계이다.

**p값**이란, 귀무가설이 옳다고 가정했을 때 관찰한 값 이상으로 극단적인 값이 나올 확률을 일컫는다. 일반적으로 p값이 0.05이하인 경우, 귀무가설 하에서 현실 데이터는 나타나기 어렵다고 생각하고,귀무가설을 버리고(기각) 대린가설을 선택한다. 이때 평균값의 차이는 **통계적으로 유의미한 차이가 있다** 라고 한다. 한편 p값이 0.05를 상회하는 경우 귀무가설을 기각할 수 없으며 **통계적으로 유의미한 차이는 발견하지 못했다** 라는 결과가 나온다. 

여기서 귀무가설을 기각할 것인지 채택할 것인지 판단 경계로 이용하는 값을 **유의수준a**라 한다. 

![Untitled](/assets/HW1/gg21.png)

# 5.2 가설검정 시행

가설검정의 개념은 다양한 검정기법에서 공통이지만, p값의 계산 방법은 서로 다르다. 대표적인 예로 2개 집단 간의 평균값을 비교하는 검정을 **이표본t검정**이라 한다. 

![Untitled](/assets/HW1/gg22.png)

![Untitled](/assets/HW1/gg23.png)

좌우 2.5%씩 유의수준 5%인 기각역이라 한다. 실제 값이 이 귀무가설이 옳을 때의 t분포 내 어디에 위치하는지 구한 뒤, 그 이상의 극단적인 값이 나올 확률을 구한것이 p값이다. 양수와 음수 양쪽 모두 고려하는 가설검정 방법을 **양측검정**, 한쪽만 고려해 넓이를 계산하는 방법은 **단측검정**이라 한다. 

![Untitled](/assets/HW1/gg24.png)

# 5.3 가설검정 관련 그래프

반복이 있는 데이터에서 평균값을 계산하여 막대그래프나 산점도로 그릴때는, 평균값에 더하여 그 위아래로 **오차막대**를 함께 그린다. 

평균값의 확률을 나타내고 싶다면, 평균값+- 표준오차를 사용한다.

데이터 퍼짐을 나타내고 싶다면 평균값+-표준편차를 사용한다. 

![Untitled](/assets/HW1/gg25.png)

# 5.4 제1종 오류와 제2종 오류

진실과 판단의 패턴

![Untitled](/assets/HW1/gg26.png)

**제1종 오류**는 실제로 아무런 차이가 없음에도 차이가 있다고 판단해 버리는 잘못을 말한다. 사실 약의 효과가 없는데도 있다고 주장하면 제1종 오류이다. 유의수준 a의 값을 미리 정해 둠으로써 제 1종 오류가 일어날 확률을 통제할 수 있다.

**제2종 오류**란 정말로 차이가 있는데도 차이가 있다고는 말할 수 없어, 귀무가설을 기각하지 않는 판단을 내려 버리는 것을 말한다. 실제로 약의 효과가 있는데 효과가 있다고 말할 수 없다고 판단하는 잘못이다. 2종오류가 일어나는 확률은 B(베타)로 나타내는데, 제2종 오류가 일어나지 않는 확률, 즉 정말로 차이가 있을 때 차이가 있다고 올바르게 판단할 확률을 **검정력** 1-B라고 한다.

일반적으로 검정력을 80%로 설멍하지만 B는 a와 달리 직접 통제할 수 없다.

a(알파)와 B(베타) 사이에는 **상충관계**, 즉 한쪽이 작아지면 또 다른 한쪽은 커지는 관계가 있다. 알파를 0.05에서 0.01로 변경하면 사실은 차이가 없는데 있다고 말해버리는 오류는 5%에서 1%로 줄일 수 있지만 한편 베타가 증가해 차이가 있는데도 있다고 말할 수 없다는 오류 늘어난다. 

그림을 보면 표본크기 n이 클수록 정말 차이가 있을 때에 그렇다고 판단할 확률인 검정력 1-베타가 상승하는 것이다.

**효과크기**는 일반적으로 얼마나 큰 효과가 있는지를 나타내는 지표이다. 

평균값의 차이에 비해 표준편차(원래의 퍼짐정도)가 클수록 2개 분포의 겹치는 부분이 커지므로 효과크기 d는 작아지고 평균값의 차이는 검출하기 어려워진다. 반대로 평균값의 차이에 비해 표준편차가 작을수록 2개 분포의 겹치는 부분은 작아지므로, 효과크기 d는 커진다고 해석할 수 있다. 

!![Untitled](/assets/HW1/gg27.png)