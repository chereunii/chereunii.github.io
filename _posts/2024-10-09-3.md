---
layout: post
title:  "8장 통계 모형화"
date:   2024-10-09 
categories: Khuda 통계101
---
# 8.1 선형회귀 원리의 확장

<7장>

양적 변수의 관계 조사하는 상관과 회귀 살펴보았다. 

하지만 실제로 설명변수가 여러 개인 경우나 반응변수가 양적변수가 아니라 범주형 변수일 때도 있어 회귀모형이 항상 적절하지 않다. 

![Untitled](/assets/HW1/ii5.png)

확장 방향성은 크게 

✔️설명변수의 개수를 늘리기

✔️반응변수의 유형 변경하기

✔️회귀모형 형태 변경하기

### 다중회귀

: 설명변수가 여러개인 것

<다중선형회귀모형>

k+1개의 파라미터를 가진다.

![Untitled](/assets/HW1/ii6.png)
![Untitled](/assets/HW1/ii7.png)

**편회귀계수:** 기울기 

![Untitled](/assets/HW1/ii8.png)

데이터에 잘 들어맞는지 나타내는 R^2값, p값 주목하기

→ 유의성 있다고 판단

### 편회귀계수

- 표준화편회귀계수

회귀분석에서 구한 편회귀계수는 설명변수의 데이터 퍼짐 정도나 단위에 따라 크게 달라져 편회귀계수끼리 비교 불가 → **표준화편회귀계수** 이용

❔회귀분석을 시행하기 전에 각각의 설명변수를 평균 0, 표준편차 1로 변환한 다음 회귀분석 시행한 회귀계수

![Untitled](/assets/HW1/ii9.png)

설명력이나 편회귀계수의 p값은 표준화하지 않은 원래 회귀결과와 똑같음.

(표준)편회귀계수 bi는 xi이외의 설명변수를 고정한 채로 xi가 1 늘어났을 때의 y증가량을 나타낸다. 

상관계수가 1에 가까운 강한 상관이 있을 때는 뒤에 설명할 다중공선성이 있는지 의심하고 이에 대처해야 한다.  

### 범주형 변수를 설명변수로

범주형 변수를 설명변수로 이용할 수도 있다. 

예/아니요, 실험군/대조군 ,혈액형(A/B/O/AB)등 설명변수를 범주로 나타낼 때 0과 1 같은 **가변수(더미변수)**를 설명변수로 이용할 수 있다.

- 범주가 3개 이상일때

e.g. 혈액형(A/B/O/AB)

2개 범주일때와 달리 4개 범주에 숫자 4개 할당할 수 없다. 혈액형 범주에는 대소관계가 없고, 선형 증가에 대응하지 않기 때문이다. 

3개의 가변수 이용( 범주 개수 -1 개 준비)

![Untitled](/assets/HW1/ii10.png)

### 공분산분석

분산분석에서는 집단 사이의 평균값 비교

회귀분석에서는 범주형 변수인 집단이 설명변수, 양적변수가 반응변수

→ **공분산분석(ANCOVA, analysis of covariance):** 분산분석과 회귀분석을 결합한 통계 기법. 독립변수와 종속변수 간의 관계를 분석하면서 동시에 제3의 연속형 변수를 **공변량**으로 사용해 종속변수에 대한 영향을 통제하는데 사용된다. 

❔일반적인 분산분석에 사용하는 데이터와 함께 양적 변수 데이터가 있는 경우에 후보가 되는 방법. 이 새로 추가한 양적변수를 **공변량** 이라 한다. 

공변량의 차이에 따라 반응 변수의 차이가 발생할 가능성을 고려한 분석을 할 수 있다.

![Untitled](/assets/HW1/ii11.png)

분산분석에는 오른쪽 위 타원으로 표시한 데이터 퍼짐을 단순 분산으로 해석하지만 공분산분석에서는 공변량에 따른 분산으로써 이를 분석할 수 있다. 그러면 회귀직선의 차이가 집단 차이로 나타나 검정력을 높일 수 있다. 

- 공분산분석 사용 조건
1. 집단 간 회귀의 기울기가 서로 다르지 않을 것→ 상호작용 없다.
2. 회귀계수가 0이 아니어야 함 → 0이면 분산분석 시행

### 고차원 데이터 문제

**차원의 저주**: 차원이 늘어날수록 파라미터 추정에 필요한 데이터 양이 폭발적으로 증가한다는 문제

차원이 증가할수록 **다중공선성 문제**가 일어나기 쉬움.

→ 차원축소(12장)

### 다중공선성

설명변수가 여러 개인 다중회귀에서 설명변수 사이에 강한 상관이 있는 경우 **다중공선성**이 있다고 한다.

회귀계수의 추정오차가 커지는 문제 발생. 즉, 추정값의 신뢰성이 떨어짐 

![Untitled](/assets/HW1/ii12.png)
![Untitled](/assets/HW1/ii13.png)

다중공선성이 문제가 되는 이유

1. 회귀계수의 불안정성
2. 회귀계수의 해석이 어려움
3. 모델의 신뢰도 감소
4. 과적합 위험 증가

→변수 제거, 주성분 분석, 정규화 회귀로 해결

다중공선성 정도를 측정하려면 **분산팽창인수 VIF(variance inflation factor)**계산해야 한다.  

하나의 설명변수 xi를 반응변수로 설정하고 나머지 설명변수를 이용해 회귀 시행한 뒤 그 결정계수 R^2을 계산하면 된다. 

![Untitled](/assets/HW1/ii14.png)

VIF>10 : 2개 사이의 상관 아주 강한 것.

다중공선성 강함→ 상관이 있는 2개 변수 중 하나 없애거나 차원 축소 방법으로 설명변수의 개수 줄이기

# 8.2 회귀모형의 형태 바꾸기

현실 데이터에서 xi가 1 증가했을 때의 y증가 방식이 또 다른 설명변수의 영향을 받을 수도 있다. 이러한 설명변수 간의 상승효과를 **상호작용**이라 하며, 선형회귀모형안에서 곱셈 cxixj로 도입할 수 있다.

설명변수 2개라면 상호작용 있는 선형회귀모형

![Untitled](/assets/HW1/ii15.png)

회귀모형에 상호작용항을 넣을 것인가의 판단은 통계 사용자가 망설이는 지점.

1. 상호작용을 넣으면 해석이 어려워짐
2. 설명변수의 개수가 늘면 상호작용항의 수가 폭발적으로 늘어남
3. 상호작용의 형태는 다양한데도 곱셈으로만 나타냄
4. 설명변수와 상호작용항의 다중공선성 문제가 있음

그러므로 다음과 같을 때에 한해 적용하는 것이 좋음

1. 상호작용이 있다는 것이 선행 연구에서 밝혀지거나 기대되는 때
2. 데이터에 분명한 상호작용이 있을 때
3. 상호작용 유무에 관심이 있을 때

### 이원배치 분산분석

하나의 요인만 다루는 일원배치 분산분석

**다원배치 분산분석** :분산분석에서 여러 개의 요인을 동시에 고려할 수 있음

![Untitled](/assets/HW1/ii16.png)

**주효과**: 각 독립 변수가 종속 변수에 미치는 직접적인 영향을 의미한다.

**상호작용 효과**: 한 독립 변수의 효과가 다른 독립 변수의 수준에 따라 어떻게 변화하는지를 보여준다. →기울기로 파악 →상호작용 효과 있다.

가설검정 결과 상호작용항 c_1이 유의미하지 않다면 상호작용이 없다고 보고 각각의 **주효과(main effect)**를 그대로 평가한다. 유의미하다면 상호작용이 있다고 보아 각각의 요인을 나누고 주효과를 하위 검정으로 평가한다. 

### 비선형회귀

파라미터가 비선형인 모형을 사용할 때 왜 그 모형을 사용하는지 합리적인 이유가 필요하다.

# 8.3 일반화선형모형의 개념

일반선형모형 원리를 확장해 최소제곱법이 아닌 확률분포에 기반한 최대가능도 방법(최대우도법)으로 회귀모형을 추정하는 **일반선형모형(GLM, Generalize Linear Model)**이 있다. 

![Untitled](/assets/HW1/ii17.png)

데이터 성질을 고려하며 확률 모형을 가정하고 파라미터를 추정해 모형을 평가하는 일련의 작업을 **통계모형화**라 부른다. 

![Untitled](/assets/HW1/ii18.png)

### 가능도와 최대가능도 방법

![Untitled](/assets/HW1/ii19.png)

확률적으로 얼마나 나타나기 쉬운가에 기반해 데이터에 잘 들어맞는지 평가하는 것이 좋다. x에 대한 파라미터 θ의 함수로 본 것을 **가능도(우도, likelihood)**라고 한다. ****

가능도가 크다는 것은, 그 θ에서 얻은 데이터가 나타나기 쉽다는 것을 뜻한다. 

가능도를 최대화하는 θ를 찾아서 이를 추정값으로 삼으면 얻은 데이터에 가장 잘 들어맞는 파라미터 θ를 정할 수 있는데 이 방법을 **최대가능도 방법, 최대가능도 추정**이라 한다. 일반적으로 가능도에 로그 취한 로그가능도로 계산할 때가 많다.

![Untitled](/assets/HW1/ii20.png)

이 세 경우에 대해 각각 로그 가능도 계산해보면 μ=50에서 가장 큰 값 → 데이터에 가장 잘 들어맞는다.

### 로지스틱 회귀

로지스틱 회귀는 반응변수 값이 2개인 범주형 변수일 때 사용하는 회귀이다. 

범주 하나가 일어날 확률을 p, 다른 하나가 일어날 확률을 1-p로 두고, 설명변수 x가 바뀌었을 때 p가 얼마나 달라지는지를 조사한다.

쉽게 말하면, 어떤 현상이 일어날 확률을 예측하는 모델, 이진분류일 때 사용된다. 

선형회귀와 달리 결과값이 0과 1 사이의 확률을 나타낸다.

![Untitled](/assets/HW1/ii21.png)

![Untitled](/assets/HW1/ii22.png)
### 오즈비

로지스틱 회귀의 결과를 오즈비(OR, odds ratio)라는 값으로 평가한다.

**오즈(승산, odds)**: 어떤 사건이 일어날 확률(p)과 일어나지 않을 확률(1-p)의 비율

![Untitled](/assets/HW1/ii23.png)

**오즈비(OR, odds ratio)**: 두 집단 간의 오즈를 비교하는 값. 특정 조건 하에서 사건이 발생할 오즈와 그렇지 않은 상황에서 사건이 발생할 오즈의 비율을 나타낸다.

![Untitled](/assets/HW1/ii24.png)

오즈비 = 1 : 두 사건의 발생 가능성 동일

오즈비>1: 첫 번째 사건이 더 자주 발생

오즈비<1: 첫 번째 사건이 덜 발생

### 푸아송 회귀

**푸아송 분포**: 어떤 사건이 일정한 시간이나 공간에서 얼마나 자주 발생하는지를 모델링할 때 사용하는 확률분포

평균과 분산이 모두 λ라는 동일한 값으로 정의된다. 

**λ**는 일정한 시간 또는 공간에서 사건이 발생하는 빈도나 횟수를 의미

![Untitled](/assets/HW1/ii25.png)

x축: 사건의 발생 횟수(1분 동안 오는 손님 수)

y축: 해당 횟수 k가 발생할 확률

**푸아송 회귀**: 푸아송 분포를 기반으로 사건 발생 횟수를 예측하는 회귀 분석 방법

### 다양한 일반화선형모형

![Untitled](/assets/HW1/ii26.png)

- 과분산

**과분산**: 분포에서 규정된 평균과 분산의 관계보다 분산이 큰 경우, 그래도 로지스틱 회귀나 푸아송 회귀 사용하면 가설검정시 제1종오류 일어날 수 있음. 

# 8.4 통계 모형의 평가와 비교

**왈드 통계량**: 표준오차를 이용해 최대가능도 방법으로 얻은 추정값/표준오차

신뢰도가 더 높은 가능도비 검정

**가능도비 검정**: 두 개의 모형을 비교할 때 사용된다. 일반적으로 더 복잡한 모형(Alternative hypothesis)과 단순한 모형(Null hypothesis)을 비교하여 단순한 모형이 데이터에 충분히 잘 설명하는지 판단

**부트스트랩 방법**: 주어진 표본에서 복원추출을 반복해 새로운 표본을 여러 번 생성하고, 이를 통해 통계량의 분포를 추정하는 방법이다. 모집단의 분포에 대한 가정 없이 신뢰구간이나 표준오차를 추정할 수 있어 유용하다. → 가능도비 검정의 통계량 분포를 추정해 검정의 정확성을 높이는 데 활용됨.

**AIC(아카이케 정보기준, Akaike information criterion)**: 새롭게 얻을 데이터를 얼마나 잘 예측할 수 있는지를 바탕으로 모형의 좋음을 결정하는 지표→ 작을수록 더 좋은 모델, 그렇다고 그것이 반드시 실제모형이지는 않을 수도 있음.

**BIC(베이즈 정보기준, Bayesian information criterion**): 모델의 적합도와 복잡도를 고려해 모델을 선택할 때 사용하는 통계쩍 지표. AIC와 유사하지만 더 강하게 모델의 복잡도에 패널티를 부여. 표본크기 n이 클수록 파라미터 개수 k의 패널티가 커짐을 알 수 있다.
